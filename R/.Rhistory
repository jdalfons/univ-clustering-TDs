library('readxl')
install.packages(readxl)
install.packages('readxl')
install.packages("readxl")
install.packages("readxl")
data <- read_excel('corvertype_100k.xlsx')
library('readxl')
data <- read_excel('corvertype_100k.xlsx')
data <- read_excel('covertype_100k.xlsx')
summary(data)
str(data)
scale(data)
data_scaled <- scale(data)
summary(data_scaled)
attr(data_scaled)
attributes(data_scaled)
attr(mean(data_scaled))
attr(data_scaled)
attr(data_scaled, which, exact = FALSE)
attributes(data)
attributes(data_scaled)
attr(data, which, exact = FALSE)
attr(data, which, exact = TRUE)
attr(data, which=scale.default())
attr(data, which="scale.centered")
attr(data, which="scale:scale")
attr(data, which="scaled:Scale")
attr(data, which="scaled:center")
attr(,"scaled:scale")
attr(data,"scaled:scale")
attr(data_scaled,"scaled:scale")
attr(data_scaled,"scaled:centered")
attr(data_scaled,"scaled:center")
attr(data_scaled,"scaled:scale")
set.seed(0)
set.seed(0)
print(set.seed(0))
set.seed(0)
print(set.seed(0))
set.seed(0)
row.names(data)
row.names(data_scaled)
km <- kmeans(data, centers=6)
print(cbind(rownames(row.names(data))))
km <- kmeans(data, centers=6)
print(cbind(rownames(row.names(data))))
print(cbind(rownames(row.names(data))))
print(cbind(rownames(row.names(data), km$cluster)))
km
View(km)
print(cbind(row.names(data), km$cluster))
km$cluster
km <- kmeans(data, centers)
km <- kmeans(data, centers=6)
km <- kmeans(data, centers=10)
print(cbind(row.names(data), km$cluster))
km$cluster
nb_groups <- 10
km <- kmeans(data, centers=nb_groups)
View(km)
km:totts
km:totss
km$totss
print(cbind(row.names(data_scaled), km$cluster))
nb_groups <- 10
km <- kmeans(data_scaled, centers=nb_groups)
nb_groups <- 10
km <- kmeans(data_scaled, centers=nb_groups)
print(cbind(row.names(data_scaled), km$cluster))
km$totss
data_scaled <- scale(data)
data <- read_excel('covertype_100k.xlsx')
data <- data[2: ncol(data)]
summary(data)
str(data)
data_scaled <- scale(data)
summary(data_scaled)
attributes(data_scaled)
attr(data_scaled,"scaled:center")
attr(data_scaled,"scaled:scale")
nb_groups <- 10
km <- kmeans(data_scaled, centers=nb_groups)
nb_groups <- 10
km <- kmeans(data_scaled, centers=nb_groups)
km$totss
print(cbind(row.names(data_scaled), km$cluster))
km$betweenss
print(cbind(row.names(data_scaled), km$cluster))
km$betweenss / km$totss
(nrow(data_scaled)-1)*1*ncol(data_scaled)
ratioBT <- km$betweenss / km$totss
print(ratioBT)
km$size
sum(km$size)
(nrow(data_scaled)-1)*1*ncol(data_scaled)
(nrow(data_scaled)-1)*ncol(data_scaled)
(nrow(data_scaled)-1)*1*ncol(data_scaled)
(nrow(data_scaled)-1)*2*ncol(data_scaled)
(nrow(data_scaled)-1)*1*ncol(data_scaled)
(nrow(data_scaled)-1)*ncol(data_scaled)
km$cluster
head(km$cluster)
km$cluster
head(km$cluster)
head(km$cluster, 10)
table(km$cluster)
print(km$size)
sum(km$size)
km$centers
dist(km)
dist(km$centers)
D <- dist(km$centers)
D <- dist(km$centers)
print(D)
table(km$cluster)
dc <- dist(km$centers)
print(dc)
cah <- hclus(dc)
cah <- hclus(dc, method="ward.D2")
cah <- hclust(dc, method="ward.D2")
cah <- hclust(dc, method="ward.D2")
plot(cah)
cah <- hclust(dc )
plot(cah)
cah <- hclust(dc, method="ward.D2", members = km$size )
plot(cah)
plot(cah, hang=1)
cah <- hclust(dc, method="ward.D2", members = km$size )
plot(cah, hang=1)
cah <- hclust(dc, method="ward.D2", members = km$size )
plot(cah, hang=-1)
groups <- cutree(cah, k=2)
print(groups)
groups <- cutree(cah, k=3)
print(groups)
groups <- cutree(cah, k=2)
print(groups)
groups <- cutree(cah, k=8)
print(groups)
groups <- cutree(cah, k=7)
print(groups)
groups <- cutree(cah, k=4)
print(groups)
groups <- cutree(cah, k=2)
print(groups)
cah <- hclust(dc, method="ward.D2", members = km$size )
plot(cah, hang=0)
cah <- hclust(dc, method="ward.D2", members = km$size )
plot(cah, hang=-1)
groups <- cutree(cah, k=4)
print(groups)
groups <- factor(groups, labels = c("A","B","C", "D"))
print(group)
print(groups)
names(groups)
table_c <- t(sapply(names(groups),
function(g)
{
v <- rep(0, nb_groups);
v[groups[c1] = 1;
table_c <- t(sapply(names(groups), function(g){v <- rep(0, nb_groups); v[groups[c1] = 1; return[v]]}))
table_c <- t(sapply(names(groups), function(g){v <- rep(0, nb_groups); v[groups[g] = 1; return[v]]}))
table_c <- t(sapply(names(groups), function(g){v <- rep(0, nb_groups); v[groups[g] = 'X'; return[v]]}))
table_c <- t(sapply(names(groups), function(g){v <- rep(0, 4); v[groups[g] = 'X'; return[v]]}))
table_c <- t(sapply(names(groups), function(g){v <- rep(0, 4); v[groups[g]] = 'X'; return[v]}))
table_c <- t(sapply(names(groups), function(g){v <- rep(0, 4); v[groups[g]] = 'X'; return{v}}))
table_c <- t(sapply(names(groups), function(g){v <- rep(0, 4); v[groups[g]] = 'X'; return(v)))
table_c <- t(sapply(names(groups), function(g){v <- rep(0, 4); v[groups[g]] = 'X'; return(v)}))
table_c <- t(sapply(names(groups), function(g){v <- rep(0, 4); v[groups[g]] = 'X'; return(v)}))
table_c
table_c <- t(sapply(names(groups), function(g){v <- rep('.', 4); v[groups[g]] = 'X'; return(v)}))
table_c
table_c <- t(sapply(names(groups), function(g){v <- rep('', 4); v[groups[g]] = 'X'; return(v)}))
table_c
table_c <- t(sapply(names(groups), function(g){v <- rep(, 4); v[groups[g]] = 'X'; return(v)}))
table_c <- t(sapply(names(groups), function(g){v <- rep('.', 4); v[groups[g]] = 'X'; return(v)}))
table_c
print(table_c(groups))
print(table(groups))
km$size
sum(km$size)
km$size
final <- as.character(groups[km$cluster])
final <- as.character(groups[km$cluster])
print(cbind(rownames(data_scaled), final)
final <- as.character(groups[km$cluster])
print(cbind(rownames(data), final)
final <- as.character(groups[km$cluster])
print(cbind(rownames(data_scaled), final)
final <- as.character(groups[km$cluster])
print(final)
clust_final = groups[km$cluster]
clust_final = groups[km$cluster]
clust_final
clust_final = groups[km$cluster]
table(clust_final)
sum(table(clust_final))
table_c <- t(sapply(names(groups), function(g){v <- rep(0, 4); v[groups[g]] = '1'; return(v)}))
table_c
table_c <- t(sapply(names(groups), function(g){v <- rep(0, 4); v[groups[g]] = 1; return(v)}))
table_c
dc <- dist(km$centers)
print(dc)
